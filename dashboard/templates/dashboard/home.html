{% extends 'base.html' %}
{% load staticfiles  %}

{% block content %}
<meta name="viewport" content="width=device-width, initial-scale=1">




<link rel="stylesheet" href="{% static 'home.css' %}">
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.bundle.min.js' type='text/javascript' ></script>



<div id="pane_container">
  <div id="left_pane" class="ui-widget-content pane">

    <!-- <div class="list-group" style="height: 100%; overflow-y: scroll">

      {% for experiment in experiments.all %}
          <div experiment-id= "{{experiment.id}}"  id="experiment{{experiment.id}}"
           ondblclick="load_experiment_data(this)" class="experiment_div list-group-item list-group-item-action">
            <span>{{experiment.start_time}}:</span>
            <span>{{experiment.rock_id}}</span>
          </div>
      {% endfor %}
    </div> -->







    <div id="accordion">
      {% for experiment in experiments %}

      <div class="card">
        <div class="card-header" data-toggle="collapse" data-target="#collapse{{experiment.id}}" aria-expanded="false" aria-controls="collapse{{experiment.id}}"
          experiment-id= "{{experiment.id}}"  id="experiment{{experiment.id}}"  class="experiment_div" >
          <h5 class="mb-0">
              <span>{{experiment.start_time|date:"d M Y"}}</span>
              <span>{{experiment.rock_id}}</span>
          </h5>
        </div>

        <div id="collapse{{experiment.id}}" class="collapse" aria-labelledby="experiment{{experiment.id}}" data-parent="#accordion">
          <div class="card-body">
            <div>
              <div><strong>Data points:</strong> <span id='total_points{{experiment.id}}'>{{experiment.data_count}}</span></div>
              <br>

              <strong>Downsample to:</strong>
              <div id="slider{{experiment.id}}" class="slider">
                <div id="custom-handle{{experiment.id}}" class="ui-slider-handle"></div>
              </div>
              <br>
              <strong>Sensor:</strong>
              <select id='sensor_select{{experiment.id}}'>
              {% for sensor in sensors.all %}
                  <option value="{{sensor.id}}">{{sensor.name}}</option>
              {% endfor %}
              </select>
              <br><br>
              <button class='btn btn-success' onclick='load_experiment_data({{experiment.id}}, "{{experiment.start_time|date:"d M Y"}}")'>Get the data >></button>
            </div>

          </div>

        </div>
      </div>

      {% endfor %}
    </div>



  </div>
  <div id="right_pane" class="ui-widget-content pane">

    <nav>
      <div class="nav nav-tabs" id="nav-tab" role="tablist"> <!--Where the tab headers are added -->
        <!-- <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Home</a> -->

      </div>
    </nav>
    <div class="tab-content" id="nav-tabContent"> <!--Where the panels of the tabs are added-->
      <!-- <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">Home</div> -->

    </div>


  </div>
</div>

<script>
var sliders = $('.slider')
for(var i=0; i<sliders.length; i++)
{
  $( function(i) {

    var handle = $( "#custom-handle"+sliders.eq(i).attr('id').slice(6) );

    $( ".slider" ).eq(i).slider({
      value: 20,
      min: 0,
      max: 100,
      step: 10,
      create: function() {
        handle.text( $( this ).slider( "value" )+"%" );
      },
      slide: function( event, ui ) {
        handle.text( ui.value+"%" );
      }
    });
  }(i) );
}

$(".ui-slider-handle").css("width", "35px")
$(".ui-slider-handle").css("height", "24px")
$(".ui-slider-handle").css("top", "50%")
$(".ui-slider-handle").css("margin-top", "-12px")
$(".ui-slider-handle").css("text-align", "center")
$(".ui-slider-handle").css("line-height", "24px")
$(".ui-slider-handle").css("font-size", '12px')



</script>


<script type="text/javascript" src="{% static 'home.js' %}" ></script>

{% endblock %}
